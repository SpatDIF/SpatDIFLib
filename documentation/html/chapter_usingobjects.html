<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>spatdiflib: Using Objects from the Jamoma API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">spatdiflib
   &#160;<span id="projectnumber">specification 0.3</span>
   </div>
   <div id="projectbrief">The Spatial Sound Description Interchange Format</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chapter_usingobjects.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using Objects from the Jamoma API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Jamoma, Timothy Place</dd></dl>
<h1><a class="anchor" id="chapter_usingobjects_lifecycle"></a>
Object Life Cycle</h1>
<h2><a class="anchor" id="chapter_usingobjects_lifecycle_createdestroy"></a>
Creating and Destroying</h2>
<p>To create an instance of a Jamoma object, create a TTObject. Internally this will look up the class in Jamoma’s registry of objects and create an instance.</p>
<p>An example below creates a stereo instance of an allpass filter, and two stereo audio signals. They are stereo because the argument given when instantiating these types of objects define the initial number of audio channels as two. You can safely ignore the fact that one of the variables is a TTAudioObjectPtr instead of a TTObjectPtr. TTAudioObject is simply a specialized version of TTObject for processing audio signals. TTAudio is also a specialized version of TTObject to represent the audio signals.</p>
<div class="fragment"><div class="line">TTAudioObject   myObject(<span class="stringliteral">&quot;allpass&quot;</span>, 2);</div>
<div class="line">TTAudio         myAudioInput(2);</div>
<div class="line">TTAudio         myAudioOutput(2);</div>
</div><!-- fragment --><p>When you are all done using the objects, you need to release them. If you have allocated the objects on the stack, as we did in the example above, this is taken care of for you.</p>
<h2><a class="anchor" id="chapter_usingobjects_lifecycle_referencecounts"></a>
Retaining and Reference Counts</h2>
<p>TTObject’s are reference counted. This means that you can create references to existing objects, and the object will not be freed until all references have been released. This is demonstrated in the following example:</p>
<div class="fragment"><div class="line">TTObject* myObject              = <span class="keyword">new</span> TTObject(“noise”, 2);</div>
<div class="line">TTObject* aReferenceToMyObject  = <span class="keyword">new</span> TTObject;</div>
<div class="line"></div>
<div class="line"><span class="comment">// reference count for internal instance inside myObject is now 1</span></div>
<div class="line"></div>
<div class="line">aReferenceToMyObject = myObject;</div>
<div class="line"></div>
<div class="line"><span class="comment">// reference count for internal instance inside myObject is now 2</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">delete</span> myObject;</div>
<div class="line"></div>
<div class="line"><span class="comment">// The myObject wrapper is deleted, but the internal object is not actually deleted</span></div>
<div class="line"><span class="comment">// reference count for internal instance inside myObject is now 1</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">delete</span> aReferenceToMyObject;</div>
<div class="line"><span class="comment">// Now, because the reference count fell to zero, the internal object is deleted</span></div>
</div><!-- fragment --><h1><a class="anchor" id="chapter_usingobjects_queryenvironment"></a>
Querying the Environment</h1>
<p>As alluded to in section 3.1, Jamoma Foundation maintains a registry of available classes that may be instantiated by name. Some of these classes are implemented internally in the Jamoma libraries, and some are implemented externally as Jamoma Extensions. The registry does not differentiate between these, but simply provides a list of everything that is loaded in the system.</p>
<h2><a class="anchor" id="chapter_usingobjects_queryenvironment_getallclassnames"></a>
Getting All Class Names</h2>
<p>To obtain a list of all class in the Foundation's registry, you call the TTObject::GetRegisteredClassNames() function as in the following example:</p>
<div class="fragment"><div class="line">TTErr err;</div>
<div class="line">TTValue classNames;</div>
<div class="line"></div>
<div class="line">err = TTObject::GetRegisteredClassNames(classNames);</div>
<div class="line"><span class="keywordflow">if</span> (!err) {</div>
<div class="line">    <span class="comment">// The classNames value now contains an array of TTSymbols, </span></div>
<div class="line">    <span class="comment">// one for each class in the Jamoma registry.</span></div>
<div class="line">    <span class="comment">// For example, we can print them all to console:</span></div>
<div class="line"></div>
<div class="line">    TTUInt16 numClassNames = classNames.size();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (TTUInt16 i=0; i&lt;numClassNames; i++) {</div>
<div class="line">        TTSymbol aClassName = classNames[i];</div>
<div class="line"></div>
<div class="line">        TTLogMessage(<span class="stringliteral">&quot;class name: %s&quot;</span>, aClassName.c_str());</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="chapter_usingobjects_queryenvironment_searchbasedontags"></a>
Searching For Classes Based on Tags</h2>
<p>In addition to retrieving all class names, it is also useful to be able to retrieve a limited number of class names based on criteria that you specify. For example, you may wish to only list classes that generate their own audio. Or perhaps only those class which implement some sort of lowpass filter.</p>
<p>In this case we call TTObject::GetRegisteredClassNamesForTags(), and process the results in the same manner as we did for TTObject::GetRegisteredClassNames(). This is demonstrated in the example below:</p>
<div class="fragment"><div class="line">TTErr err;</div>
<div class="line">TTValue classNames;</div>
<div class="line">TTValue searchTags;</div>
<div class="line"></div>
<div class="line">searchTags.clear();</div>
<div class="line">searchTags.append(TT(<span class="stringliteral">&quot;audio&quot;</span>));</div>
<div class="line">searchTags.append(TT(<span class="stringliteral">&quot;filter&quot;</span>));</div>
<div class="line">searchTags.append(TT(<span class="stringliteral">&quot;lowpass&quot;</span>));</div>
<div class="line"></div>
<div class="line">err = TTGetRegisteredClassNamesForTags(classNames, searchTags);</div>
<div class="line"><span class="keywordflow">if</span> (!err) {</div>
<div class="line">    <span class="comment">// The classNames value now contains an array of TTSymbols, </span></div>
<div class="line">    <span class="comment">// one for each class in the Jamoma registry.</span></div>
<div class="line">    <span class="comment">// For example, we can print them all to console:</span></div>
<div class="line"></div>
<div class="line">    TTUInt16 numClassNames = classNames.getSize();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (TTUInt16 i=0; i&lt;numClassNames; i++) {</div>
<div class="line">        TTSymbol aClassName = classNames[i];</div>
<div class="line"></div>
<div class="line">        TTLogMessage(<span class="stringliteral">&quot;class name: %s&quot;</span>, aClassName.c_str());</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>For a list of common tags and what they mean in Jamoma see Appendix B. To get a list of all tags in use at any time, call TTObject::GetRegisteredTags().</p>
<h3><a class="anchor" id="chapter_usingobjects_queryenvironment_searchbasedontags_example"></a>
Tag Searching and Instantiation in Action</h3>
<p>Here is an example that searches based on tags for a lowpass filter using a Butterworth algorithm, and then creates an instance of that class.</p>
<div class="fragment"><div class="line"><span class="comment">// In this case there are multiple matches returned. </span></div>
<div class="line"><span class="comment">// Since more specific information was not provided, </span></div>
<div class="line"><span class="comment">// we just instantiate the first one.</span></div>
<div class="line"></div>
<div class="line">TTErr             err;</div>
<div class="line">TTValue           classNames;</div>
<div class="line">TTValue           searchTags;</div>
<div class="line">TTAudioObject     butterworthFilter;</div>
<div class="line"></div>
<div class="line">searchTags.clear();</div>
<div class="line">searchTags.append(TTSymbol(<span class="stringliteral">&quot;audio&quot;</span>));</div>
<div class="line">searchTags.append(TTSymbol(<span class="stringliteral">&quot;filter&quot;</span>));</div>
<div class="line">searchTags.append(TTSymbol(<span class="stringliteral">&quot;lowpass&quot;</span>));</div>
<div class="line">searchTags.append(TTSymbol(<span class="stringliteral">&quot;butterworth&quot;</span>));</div>
<div class="line"></div>
<div class="line">err = TTObject::GetRegisteredClassNamesForTags(classNames, searchTags);</div>
<div class="line"><span class="keywordflow">if</span> (!err) {</div>
<div class="line">    <span class="comment">// for this example, we can just instantiate the first one in the list</span></div>
<div class="line">    butterworthFilter = TTAudioObject(classNames[0]);</div>
<div class="line">}</div>
<div class="line"><span class="comment">// now do something with the filter.</span></div>
</div><!-- fragment --><h1><a class="anchor" id="chapter_usingobjects_sendingmessages"></a>
Sending Messages</h1>
<p>Having created an instance of an object, we must now do something with that object. We do things with objects by sending them messages. A message defines an action to be performed.</p>
<p>Given the Butterworth filter example in <a class="el" href="chapter_usingobjects.html#chapter_usingobjects_queryenvironment_searchbasedontags_example">Tag Searching and Instantiation in Action</a>, we can now send the filter the 'clear' message to zero its sample history </p>
<dl class="section note"><dt>Note</dt><dd>The Butterworth filter is an IIR filter, meaning that it stores the results of previous calculations to perform future calculations. This feedback can sometimes get out of control, and thus the necessity for a 'clear' message.</dd></dl>
<div class="fragment"><div class="line">butterworthFilter.send(<span class="stringliteral">&quot;clear&quot;</span>);</div>
</div><!-- fragment --><p>Some messages, like the 'clear' message for the Butterworth filter, require no additional information to perform the requested action. Other messages, however, do require additional information. This information can be provided using an optional arguments to the send() method. Here are some samples:</p>
<div class="fragment"><div class="line">TTValue returnValue;</div>
<div class="line">TTValue dummy;</div>
<div class="line"></div>
<div class="line">someObject.send(<span class="stringliteral">&quot;foo&quot;</span>, 3.14, returnValue);</div>
<div class="line">someObject.send(<span class="stringliteral">&quot;draw&quot;</span>, <span class="stringliteral">&quot;circle&quot;</span>, returnValue);</div>
<div class="line"></div>
<div class="line"><span class="comment">// create a TTValue that holds a list and pass the TTValue</span></div>
<div class="line">TTValue v(1.0, 2.0));</div>
<div class="line">someObject.send(<span class="stringliteral">&quot;w&quot;</span>, v, returnValue);</div>
<div class="line"></div>
<div class="line"><span class="comment">// when you send a message, it can return a value in the third argument.</span></div>
<div class="line">TTErr   err;</div>
<div class="line"></div>
<div class="line">err = someObject-&gt;sendMessage(<span class="stringliteral">&quot;getContents&quot;</span>, dummy, returnValue);</div>
<div class="line"><span class="keywordflow">if</span> (!err) {</div>
<div class="line">    <span class="comment">// Assuming that someObject understands the message, </span></div>
<div class="line">    <span class="comment">// this results in returnValue being set to contain something meaningful.   </span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (err == kTTErrMethodNotFound) {</div>
<div class="line">    <span class="comment">// The object didn&#39;t understand this message&#39;</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// There was some other problem.</span></div>
<div class="line">    <span class="comment">// Probably the object you sent the message to knows this message and is returning </span></div>
<div class="line">    <span class="comment">// an error specific to the action you requested.</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="chapter_usingobjects_setgetattributes"></a>
Setting and Getting Attributes</h1>
<p>Sending messages is great for performing actions, however these actions do not represent the state of the object. The state of the object is represented as the object's 'attributes'.</p>
<h1><a class="anchor" id="chapter_usingobjects_queryavailable"></a>
Querying Objects for Available Messages and Attributes</h1>
<h1><a class="anchor" id="chapter_usingobjects_processingaudios"></a>
Processing Audio</h1>
<p>Not all objects can process audio, however, objects that have the tag ‘audio’ associated with them are able process audio. These objects derive from #TTAudioObjectBase, a subclass of #TTObjectBase which implements the “process” method. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 6 2014 15:45:42 for spatdiflib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
